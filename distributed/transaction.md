#Transaction#
1. XA：两阶段方案提交
	
	spring + JTA
	先询问，后执行![](https://i.imgur.com/7P6z5wv.png)
	![](https://i.imgur.com/ekqiYQy.png)

2. TCC方案： try、confirm、cancel
	
	适用于资金类业务，实现复杂，需要写大量业务代码，重耦合且难以维护
	![](https://i.imgur.com/fnVc3hL.png)

3. 本地消息表[国外ebay]

	大量依赖消息表
	![](https://i.imgur.com/NJ7b9sU.png)

4. 可靠消息最终一致性方案

	可以基于 阿里的rocketMq[3.2.6,之后的回调接口被去掉了] 做
	![](https://i.imgur.com/tc07grO.png)
	不断重发，rocketMq支持消息的序列化，用这个确保消息一定能发过去

5. 最大努力同性质方案

	![](https://i.imgur.com/yu2cf0S.png)

	如果系统少，没必要弄分布式事务；可以从调系统接口的返回值判断操作是否成功，然后才去调下一个系统的接口
	因为分布式事务，系统TPS[吞吐量]、性能也大幅会下降，并且会让系统代码更加复杂更容易出bug。

	不用分布式事务，成本低。

	99%的分布式接口调用，不要做分布式事务，直接就是监控（发邮件、发短信）、记录日志（一旦出错，完整的日志）、事后快速的定位、排查和出解决方案、修复数据。

	1%，0.1%的业务，资金、交易、订单，我们会用分布式事务方案来保证，会员积分、优惠券、商品信息，就不需要了。