# 一致性哈希算法 

----------------------------------------------------

​	提到一致性哈希则不得不提传统哈希表，而传统哈希表有什么弊端呢？

​		下面通过一个实际应用场景，我们来快速了解一下传统hash表的弊端。

​	或许你听说过`负载均衡`技术，不明白的可以看 [这里](https://juejin.im/entry/5aeb158f518825672033e90f)。在此基础上，如何实现一个`会话粘滞（session sticky）`的负载均衡算法呢？也就是说，我们需要在同一个客户端上，在一次会话中的所有请求都路由到同一个服务器上。

- 最直接的方法就是，维护一张映射关系表，这张表的内容是客户端 IP 地址或者会话 ID 与服务器编号的映射关系。
  - 如果客户端很多，映射表可能会很大，比较浪费内存空间；
  - 客户端下线、上线，服务器扩容、缩容都会导致映射失效，这样维护映射表的成本就会很大；
- 我们可以通过哈希算法，对客户端 IP 地址或者会话 ID 计算哈希值，将取得的哈希值与服务器列表的大小进行`取模`运算，最终得到的值就是应该被路由到的服务器编号。 这样，我们就可以把同一个 IP 过来的所有请求，都路由到同一个后端服务器上。